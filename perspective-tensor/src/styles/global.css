@import "tailwindcss";
@plugin "@tailwindcss/typography";
@custom-variant dark (&:where(.dark, .dark *));

/* Theme Configuration */
@theme {
  /* Custom fonts */
  --font-display: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Avenir Next', Avenir, 'Segoe UI', sans-serif;
  --font-body: 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

/* Typography colors for prose */
:root {
  /* Light mode */
  --prose-body: #374151;
  --prose-headings: #111827;
  --prose-links: #374151;
  --prose-bold: #111827;
  --prose-quotes: #4b5563;
  --prose-quote-borders: #d1d5db;
  --prose-code: #111827;
  --prose-code-bg: #f3f4f6;
  --prose-pre-bg: #f9fafb;
  --prose-pre-code: #1f2937;
  --prose-hr: #d1d5db;
}

.dark {
  /* Dark mode */
  --prose-body: #d1d5db;
  --prose-headings: #f9fafb;
  --prose-links: #d1d5db;
  --prose-bold: #f9fafb;
  --prose-quotes: #9ca3af;
  --prose-quote-borders: #4b5563;
  --prose-code: #f9fafb;
  --prose-code-bg: #1f2937;
  --prose-pre-bg: #111827;
  --prose-pre-code: #e5e7eb;
  --prose-hr: #4b5563;
}

/* Base layer */
@layer base {
  :root {
    color-scheme: light dark;
  }
  
  html, body {
    min-height: 100%;
    font-family: var(--font-body);
  }
  
  /* Reserve scrollbar space */
  html {
    scrollbar-gutter: stable both-edges;
  }
}

/* Components layer */
@layer components {
  /* Display font utility */
  .font-display {
    font-family: var(--font-display);
  }
}

/* Utilities layer */
@layer utilities {
  /* Dynamic footer spacing */
  footer {
    margin-top: clamp(0.5rem, 1vh, 1rem);
  }
  
  @media (min-height: 800px) {
    footer {
      margin-top: clamp(0.75rem, 1.5vh, 1.5rem);
    }
  }
  
  @media (min-height: 1000px) {
    footer {
      margin-top: clamp(1rem, 2vh, 2rem);
    }
  }
}


/* Focus and transition defaults */
@layer base {
  /* Focus states */
  :focus-visible {
    @apply outline-2 outline-gray-500 outline-offset-2;
  }
  
  button:focus-visible {
    @apply outline-2 outline-gray-500 outline-offset-2;
  }
}

/* Default transitions */
@layer base {
  *:where(:not([class*="transition"])) {
    transition-property: border-color, text-decoration-color, fill, stroke, opacity;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 150ms;
  }
}

/* Content optimizations */
@layer base {
  /* Code blocks */
  pre code {
    @apply bg-transparent p-0;
  }
  
  /* Images */
  img {
    @apply h-auto max-w-full;
  }
}

/* Shiki syntax highlighting theme switching */
@layer base {
  /* Base code block styling */
  .astro-code {
    @apply rounded-md p-1 my-4;
    border: 1px solid transparent;
  }
  
  /* Light mode (default) */
  .astro-code {
    background-color: #f6f8fa !important;
    border-color: #d1d5da !important;
  }
  
  .astro-code,
  .astro-code span {
    color: var(--shiki-light) !important;
    font-style: var(--shiki-light-font-style) !important;
    font-weight: var(--shiki-light-font-weight) !important;
    text-decoration: var(--shiki-light-text-decoration) !important;
  }
  
  .astro-code span {
    background-color: transparent !important;
  }
  
  /* Dark mode */
  .dark .astro-code {
    background-color: #161b22 !important;
    border-color: #30363d !important;
  }
  
  .dark .astro-code,
  .dark .astro-code span {
    color: var(--shiki-dark) !important;
    font-style: var(--shiki-dark-font-style) !important;
    font-weight: var(--shiki-dark-font-weight) !important;
    text-decoration: var(--shiki-dark-text-decoration) !important;
  }
  
  .dark .astro-code span {
    background-color: transparent !important;
  }
  
  /* Use media query as fallback */
  @media (prefers-color-scheme: dark) {
    html:not(.light) .astro-code {
      background-color: #161b22 !important;
      border-color: #30363d !important;
    }
    
    html:not(.light) .astro-code,
    html:not(.light) .astro-code span {
      color: var(--shiki-dark) !important;
      font-style: var(--shiki-dark-font-style) !important;
      font-weight: var(--shiki-dark-font-weight) !important;
      text-decoration: var(--shiki-dark-text-decoration) !important;
    }
    
    html:not(.light) .astro-code span {
      background-color: transparent !important;
    }
  }
}

/* Print styles */
@media print {
  .dark {
    --prose-body: theme('colors.gray.700');
    --prose-headings: theme('colors.gray.900');
    --prose-links: theme('colors.gray.600');
    --prose-code: theme('colors.gray.900');
  }
}